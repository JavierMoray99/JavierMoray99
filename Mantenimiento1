Objetivo:
Mantenimiento de asientos contables.
ENTORNO:
W_NRO_ASIENTO       es numérico
W_NRO_CUENTA        es numérico
W_OPCION            es alfanumérico
W_RESPUESTA         es alfanumérico
W_TIPO_MOVIM        es alfanumérico

archivo CUENTA
registro REG_CUENTA
  NRO_CUENTA        es numérico
  DESCRIPCION       es alfanumérico
  TIPO_CUENTA       es alfanumérico
  ASENTABLE         es alfanumérico
  TOTAL_DEBITOS     es numérico
  TOTAL_CREDITOS    es numérico
fin_registro
prefijo CUE

archivo ASIENTO
registro REG_ASIENTO
  NRO_ASIENTO       es numérico
  NRO_MOVIMIM       es numérico
  NRO_CUENTA        es numérico
  PERIODO           es alfanumérico
  IMPORTE_DEBITO    es numérico
  IMPORTE_CREDITO   es numérico
fin_registro
prefijo ASI

CUERPO PRINCIPAL:
inicio
  ejecutar PROCESO_INICIAL
  mientras W_NRO_ASIENTO <> 0
      ejecutar PROCESO_PRINCIPAL
  fin_mientras
  ejecutar PROCESO_FINAL
 fin
RUTINAS:
PROCESO_INICIAL:
  imprimir " MANTENIMIENTOS DE ASIENTOS CONTABLES"
  ejecutar ABRIR_ARCHIVOS
  ejecutar INGRESAR_NRO_CUENTA
  ejecutar INGRESAR_NRO_ASIENTO
retorno

PROCESO_PRINCIPAL:
  ejecutar INGRESAR_NRO_MOVIM
  ejecutar LEER_ASIENTO
     si existe (ASIENTO)
        ejecutar INGRESAR_NRO_CUENTA
        ejecutar LEER_CUENTA
        ejecutar VALIDAR_CUENTA
     sino
        ejecutar ALTA_ASIENTO
        ejecutar INGRESAR_OPCION_MANTENIMIENTO
        si W_OPCION = "B"
           ejecutar BAJA_ASIENTO
        sino
          si W_OPCION = "BM"
            ejecutar BAJA_MOVIMIENTO
          sino
            W_OPCION = "A"
            ejecutar ACTUALIZAR_CUENTA
        fin_si
      fin_si
      ejecutar LEER_NRO_ASIENTO
retorno
PROCESO_FINAL:
  ejecutar CERRAR_ARCHIVOS
  imprimir "** FIN DEL ARCHIVO**"
retorno
ABRIR_ARCHIVOS:
   ejecutar ABRIR_ARCHIVO_ASIENTO
   ejecutar ABRIR_ARCHIVO_CUENTA
retorno

ABRIR_ARCHIVO_ASIENTO
  abrir ASIENTO
retorno
ABRIR_ARCHIVO_CUENTA
  abrir CUETNA
retorno
INGRESAR_NRO_ASIENTO:
  ingresar "Numero de asinto (ENTER p/ fin):", ASI_NRO_ASIENTO
retorno  
INGRESAR_NRO_MOVIM:
  ingresar "NRO DE MOVIMIENTO: ", ASI_NRO_MOVIM
retorno  
INGRESAR_NRO_CUENTA:
  ingresar "Numero de cuenta:", CUE_NRO_CUENTA
ALTA_ASIENTO:
  INGRESAR "Asiento inexistene, desea agregar? (S/N):", W_RESPUESTA
  si W_RESPUESTA = "S"
  ejecutar INGRESAR_DATOS_ASIENTO
  ejecutar INGRESAR_CONFIRMACION
  si W_W_RESPUESTA = "S"
    grabar REG_ASIENTO
  fin_si
retorno

BAJA_ASIENTO:
  ejecutar LEER_ASIENTO
  ejecutar INGRESAR_CONFIRMACION
  si W_RESPUESTA = "S"
    borrar REG_ASIENTO
    ASI_IMPORTE_CREDITO = ASI_IMPORTE_CREDITO - CUE_TOTAL_DEBITOS
  fin_si
retorno

ACTUALIZAR_CUENTA:
  ejecutar INGRESAR_DATOS_CUENTA
  ejecutar INGRESAR_CONFIRMACION
  si W_RESPUESTA = "S"
      regrabar REG_CUENTA
  fin_si    
LEER_ASIENTO:
  ASI_NRO_ASIENTO = W_NRO_ASIENTO 
  clave ASI_NRO_ASIENTO + ASI_NRO_MOVIM
  leer REG_ASIENTO
retorno
LEER_CUENTA:
  CUE_NRO_CUENTA = W_NRO_CUENTA
  clave CUE_NRO_CUENTA
  leer REG_CUENTA
retorno  
VALIDAR_CUENTA
  ejecutar LEER_CUENTA
  si existe(CUENTA)
      repetir
          ingresar "INGRESE SI EL TIPO DE CUENTA ES ASENTABLE", CUE_ASENTABLE
      hasta CUE_ASENTABLE = "S"
      ejecutar IMPRIMIR_DESCRIPCION
   sino
      INGRESAR_NRO_CUENTA
   fin_si   
ejecutar INGRESAR_DATOS_CUENTA
  ingresar "DESCRIPCION", CUE_DESCRIPCION
  repetir
      ingresar "Ingrese tipo de cuenta (D= Deudora A= Acreedora)", CUE_TIPO_CUENTA
  hasta CUE_TIPO_CUENTA = "D" or  "A"
  repetir
      ingresar "es asentable?" (S/N)", CUE_ASENTABLE
  hasta CUE_ASENTABLE = "S" or "N"
IMPRIMIR_DESCRIPCION:
  imprimir "NRO_ASIENTO ", ASI_NRO_ASIENTO
  imprimir "NRO MOVIMIENTO ", ASI_NRO_MOVIM
  imprimir "NRO CUENTA ", ASI_NRO_CUENTA
  imprimir "PERIODO ", ASI_PERIODO
  imprimir "IMPORTE DEBITO ", ASI_IMPORTE_DEBITO
  imprimir "IMPORTE CREDITO ", ASI_IMPORTE_CREDITO
retorno
INGRESAR_DATOS_ASIENTO:
  ingresar "Perido", ASI_PERIODO
  repetir
      ingresar "Ingrese el tipo de movimiento (D = debito C= credito)", W_TIPO_MOVIM
  hasta W_TIPO_MOVIM = "D" or "C"
  Ingresar "Ingrese el importe debito: ", ASI_IMPORTE_DEBITO
  ingresar "Ingrese el importe Credito: ", ASI_IMPORTE_CREDITO
retorno
INGRESAR_OPCION_MANTENIMIENTO:
  repetir
      ingresar "DESEA (B= BAJA ASIENTO, BM= BAJA MOVIMIENTO, A= ACTUALIZAR CUAENTA, C= CONSULTA: ", W_OPCION
  hasta W_OPCION = "B" or "BM" or "A" or "C"   
retorno
INGRESAR_CONFIRMACION:
  repetir
    ingresar "CONFIRMA ESTA OPERACION ? (S/N): ", W_RESPUESTA
  hasta W_OPCION = "S" or "N"
retorno
CERRAR_ARCHIVOS
  ejecutar CERRAR_ARCHIVO_ASIENTO
  ejecutar CERRAR_ARCHIVO_CUENTA
retorno  
CERRAR_ARCHIVO_ASIENTO
    cerrar ASIENTO
retorno
CERRAR_ARCHIVO_CUENTA
    cerrar CUENTA
retorno    
