Objetivo:
  Mantenimiento de Formulas
  Entorno
  W_COD_FORMULA      es numérico
  W_OPCION           es numérico
  W_RESPUESTA        es numérico
  
archivo MATPRIMA
registro REG_MATPRIMA
  COD_MATPRI        es numérico
  DESCRIPCION       es alfanumérico
  UNI_MEDIDA        es alfanumérico
  EXI_ACTUAL        es numérico
  COSTO             es numérico
fin_registro 
prefijo MAP

arhivo FORMULA
registro REG_FORMULA
  COD_FORMULA       es numérico
  COD_MATPRI        es numérico
  CANT_UNITARIA     es numérico
fin_registro
prefijo FOR

archivo ORDEN 
registro REG_ORDEN
  NRO_ORDEN         es numérico
  COD_FORMULA       es numérico
  CANTIDAD          es numérico
  APROBADA          es alfanumérico

CUERPO PRINCIPAL:
inicio
  ejecurar PROCESO_INICIAL
  mientras W_COD_FORMULA <> 0
     ejecurar PROCESO_PRINCIPAL
  fin_mientras    
  ejecutar PROCESO_FINAL
fin
PROCESO_INICIAL:
  imprimir "Mantenimiento de Formulas"
  ejecutar ABRIR_ARCHIVOS
  ejecutar INGRESAR_COD_FORMULA
retorno

PROCESO_PRINCIPAL:
  ejecutar LEER_FORMULA
  si existe (FORMULA)
    ejecutar LEER_MATPRIMA
    si existe (MATPRIMA)
       mientras W_COD_MATPRI = 0
          INGRESAR_COD_FORMULA
       fin_mientras
       ejecutar INGRESAR_OPCION_MANTENIMIENTO
       si W_OPCION = "B"
         ejecutar BAJA_MATEPRI
       sino
        si W_OPCION = "M"
           ejecutar MODIFICACION_FOR
        fin_si
        sino
           ejecutar BAJA_COMPLETA
        fin_si   
     sino
        ejecutar ALTA_MATEPRI
     fin_si
   sino
      imprimir "Error, la formula no existe"
   fin_si
retorno

PROCESO_FINAL:
  ejecutar CERRAR_ARCHIVOS
  imrpmir "** FIN DEL PROCESO **"
retorno
** RUTINAS PRINCIPALES **
ABRIR_ARCHIVOS:
  ejecutar ABRIR_ARCHIVO_FORMULA
  ejecutar ABRIR_ARCHIVO_MATPRIMA
  ejecutar ABRIR_ARCHIVO_ORDEN
retorno

ALTA_MATEPRI:
  ingresar "Desea ingresar la materia prima de esta formula?, ¿Desea agregarlo? (S/N):", W_RESPUESTA
  ejecutar INGRESAR_DATOS_MATEPRI
    ejecutar INGRESAR_CONFIRMACION
  si W_RESPUESTA = "S"
     grabar REG_MATPRIMA
  fin_si
retorno
BAJA_MATEPRI:
  ejecutar UBICAR_FORMULA_CLAVE2
  mientas FOR_COD_MATPRI = W_COD_FORMULA
      ejecutar INGRESAR_CONFIRMACION
      si W_RESPUESTA = "S"
          borrar REG_MATPRIMA
    fin_si
  fin_mientras
retorno
MODIFICACION_FOR:
  ingresar "Ingrese la nueva cantidad unitaria:", FOR_CANT_UNITARIA
  si W_RESPUESTA = "S"
    regrabar REG_FORMULA
  fin_si
retorno
BAJA_COMPLETA:

CERRAR_ARCHIVOS:
  ejecutar CERRAR_ARCHIVO_MATPRIMA
  ejecutar CERRAR_ARCHIVO_FORMULA
  ejecutar CERRAR_ARCHIVO_ORDEN
retorno
